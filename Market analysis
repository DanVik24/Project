# Импортирт библиотек
import pandas as pd
import matplotlib.pyplot as plt
data_all = pd.read_csv('C:/Users/admin/all/offers all.csv', sep=';')

# Загружаем данные и смотрим основную информацию 

display(data_all.head())
display(data_all.info())

# переименование столбцов
data_all= data_all.rename(columns={'Количество комнат': 'rooms', 
                               'Тип': 'type', 
                               'район': 'district', 
                               'Адрес': 'address', 
                               'Площадь, м2': 'area',
                               'Этаж': 'floor', 
                               'Цена': 'price', 
                               'Ремонт': 'repair', 
                               'Ссылка на объявление': 'link'})

data_all['rooms'].unique() #поиск уникальных названий

display(data_all.head())
display(data_all.info())

data_all['rooms'].unique() #поиск уникальных названий

data_all['rooms'].value_counts()

data_all['rooms'] = data_all['rooms'].fillna(0).astype('int')

data_all.query('rooms == 0')

# изменим тип данных для дальнейшего исследовани в следующих столбцах
data['rooms'] = data['rooms'].fillna(0).astype('int')
data['area'] = data['area'].fillna(0).astype('int')
data['floor'] = data['floor'].fillna(0).astype('int')

data.isnull().sum() #отпределяю пропущенные значения в столбцах

# пропуски в столбцах, где указн ремон заменим на 0 как "нет информации о ремонте"
data['repair'] = data['repair'].fillna(0)

#добавление столбца - количество этажей в доме
data['floor_all'] = data['floor'].str.split('/').str.get(1)
data['floor'] = data['floor'].str.split('/').str.get(0)
data